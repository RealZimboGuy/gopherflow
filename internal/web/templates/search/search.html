{{ define "search" }}

<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>

    {{ template "header" . }}

</head>
<body class="bg-sky-50 font-sans leading-normal tracking-normal">
<div class="flex h-screen">
    <!-- Sidebar -->
    <aside class="w-64 bg-slate-900 text-slate-100 flex flex-col">
        <div class="p-6 text-center font-bold text-lg tracking-wide">
            <span class="inline-flex items-center gap-2">
                <span class="inline-block w-2 h-2 rounded-full bg-cyan-500"></span>
                GopherFlow
            </span>
        </div>

        {{ template "nav" . }}

    </aside>

    <!-- Main Content -->
    <div class="flex flex-col flex-grow overflow-scroll" id="main-content">
        <!-- Top Bar -->
        <header class="bg-white shadow-md py-4 px-6 flex justify-start">
            <h1 class="text-xl font-semibold text-gray-800">{{ .Title }}</h1>
        </header>

        <main class="p-6 flex-grow">
            <section class="bg-white rounded shadow-md p-6 mb-4">
                <div class="flex items-center gap-3">
                    <input type="hidden" id="offset" name="offset" value="0" />
                    <input id="q" name="q" type="text" placeholder="Search by ID, External ID, Business Key..."
                           class="w-full p-2 border border-cyan-200 rounded"
                           hx-get="/search/results"
                           hx-trigger="load, keyup changed delay:300ms, search" 
                           hx-target="#results"
                           hx-include="#q,#status,#state,#workflowType,#executorGroup,#limit,#offset"
                    />
                    <select id="status" name="status" class="p-2 border border-cyan-200 rounded" 
                            hx-get="/search/results" hx-trigger="change" hx-target="#results" hx-include="#q,#status,#state,#workflowType,#executorGroup,#limit,#offset">
                        <option value="">Status</option>
                        <option>NEW</option>
                        <option>IN_PROGRESS</option>
                        <option>EXECUTING</option>
                        <option>SCHEDULED</option>
                        <option>DONE</option>
                        <option>ERROR</option>
                    </select>
                    <input id="state" name="state" type="text" placeholder="State" class="p-2 border border-cyan-200 rounded"
                           hx-get="/search/results" hx-trigger="load, keyup changed delay:300ms" hx-target="#results" hx-include="#q,#status,#state,#workflowType,#executorGroup,#limit,#offset"/>
                    <select id="workflowType" name="workflowType" class="p-2 border border-cyan-200 rounded"
                            hx-get="/search/results" hx-trigger="change" hx-target="#results" hx-include="#q,#status,#state,#workflowType,#executorGroup,#limit,#offset">
                        <option value="">All types</option>
                        {{- range .WorkflowTypes }}
                        <option value="{{ . }}">{{ . }}</option>
                        {{- end }}
                    </select>
                    <input id="executorGroup" name="executorGroup" type="text" placeholder="Executor Group" class="p-2 border border-cyan-200 rounded"
                           hx-get="/search/results" hx-trigger="load, keyup changed delay:300ms" hx-target="#results" hx-include="#q,#status,#state,#workflowType,#executorGroup,#limit,#offset"/>
                    <select id="limit" name="limit" class="p-2 border border-cyan-200 rounded" hx-get="/search/results" hx-trigger="change" hx-target="#results" hx-include="#q,#status,#state,#workflowType,#executorGroup,#limit,#offset">
                        <option value="20">20</option>
                        <option value="50" selected>50</option>
                        <option value="100">100</option>
                    </select>
                </div>
            </section>

            <section id="results" class="bg-white rounded shadow-md p-6">
                {{ template "search_results" .ResultsData }}
            </section>
        </main>
    </div>
</div>
</body>
</html>
{{ end }}
